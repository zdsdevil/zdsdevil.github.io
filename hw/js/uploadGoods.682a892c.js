(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["uploadGoods"],{8129:function(e,t,a){},"9cfd":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"uploadGoods"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"img",prop:"img"}},[e._l(e.uploadList,function(t,o){return a("div",{key:o,staticClass:"demo-upload-list"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return e.handleView(t.name)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return e.handleRemove(t)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"100px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:"",headers:e.headers,type:"drag",action:"/security/pic"}},[a("div",{staticStyle:{width:"100px",height:"100px","line-height":"100px"}},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),a("Modal",{staticClass:"previewImg",model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v("View Image")])]),e.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:"http://47.107.166.120:8000/hw/files/"+e.imgName}}):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"})])],2),a("FormItem",{attrs:{label:"name",prop:"name"}},[a("Input",{attrs:{placeholder:"Enter your name"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),a("FormItem",{attrs:{label:"deposit",prop:"deposit"}},[a("Input",{attrs:{type:"number",placeholder:"Enter your deposit"},model:{value:e.formValidate.deposit,callback:function(t){e.$set(e.formValidate,"deposit",t)},expression:"formValidate.deposit"}})],1),a("FormItem",{attrs:{label:"rentalCost",prop:"rentalCost"}},[a("Input",{attrs:{type:"number",placeholder:"Enter your rentalCost"},model:{value:e.formValidate.rentalCost,callback:function(t){e.$set(e.formValidate,"rentalCost",t)},expression:"formValidate.rentalCost"}})],1),a("FormItem",{attrs:{label:"type",prop:"type"}},[a("Select",{attrs:{placeholder:"Select type"},model:{value:e.formValidate.type,callback:function(t){e.$set(e.formValidate,"type",t)},expression:"formValidate.type"}},e._l(e.goodsTypeList,function(t,o){return a("Option",{key:o,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1),a("FormItem",{attrs:{label:"addr",prop:"addr"}},[a("Input",{attrs:{placeholder:"Enter your addr"},model:{value:e.formValidate.addr,callback:function(t){e.$set(e.formValidate,"addr",t)},expression:"formValidate.addr"}})],1),a("FormItem",{attrs:{label:"desc",prop:"desc"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:e.formValidate.desc,callback:function(t){e.$set(e.formValidate,"desc",t)},expression:"formValidate.desc"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("Submit")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleReset("formValidate")}}},[e._v("Reset")])],1)],1)],1)},i=[],r=a("59ad"),l=a.n(r),s=(a("7f7f"),a("7e1e")),n=a("c276"),d={data:function(){return{headers:{},formValidate:{addr:"",deposit:"",desc:"",name:"",rentalCost:"",type:"",city:""},goodsTypeList:[],defaultList:[],imgName:"",visible:!1,uploadList:[],cur_uploadImg:null,ruleValidate:{deposit:[{required:!0,message:"deposit cannot be empty",trigger:"blur"}],name:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],rentalCost:[{required:!0,message:"rentalCost cannot be empty",trigger:"blur"}]}}},methods:{handleSubmit:function(e){var t=this;0!==t.uploadList.length?t.$refs[e].validate(function(e){if(e){var a=t.uploadList.map(function(e){return e.name});console.log(a),Object(s["i"])({addr:t.formValidate.addr,deposit:l()(t.formValidate.deposit),desc:t.formValidate.desc,name:t.formValidate.name,rentalCost:l()(t.formValidate.rentalCost),type:l()(t.formValidate.type),picUrls:a}).then(function(e){console.log("res",e.data),"success"===e.data.msg?(t.$Message.success(e.data.msg),t.handleReset("formValidate"),t.$refs.upload.fileList.splice(0,t.$refs.upload.fileList.length)):t.$Message.error(e.data.msg)}).catch(function(e){console.log(e)})}}):t.$Message.error("Please upload at least one picture")},handleReset:function(e){this.$refs[e].resetFields()},handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){t.url="http://47.107.166.120:8000/hw/files/"+e.data,t.name=e.data},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var e=this.uploadList.length<5;return e||this.$Notice.warning({title:"Up to five pictures can be uploaded."}),e}},mounted:function(){var e=this;e.headers["hw-token"]=Object(n["g"])(),e.uploadList=e.$refs.upload.fileList,Object(s["d"])().then(function(t){console.log(t),e.goodsTypeList=t.data.data})}},c=d,p=(a("bb1a"),a("2877")),m=Object(p["a"])(c,o,i,!1,null,"036782bc",null);t["default"]=m.exports},bb1a:function(e,t,a){"use strict";var o=a("8129"),i=a.n(o);i.a}}]);