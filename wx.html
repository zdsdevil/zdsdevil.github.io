<!DOCTYPE html>
<html>
<head lang = "en">
  <meta charset = "UTF-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
  <title>devil_zds</title>
  <link rel="stylesheet" href="css/src/reset.css">
  <link rel="stylesheet" href="css/src/resume.css">
</head>
<body>

<span id="musicControl">
    <a id="mc_play" class="stop on" onclick="play_music();">
      <audio id="musicfx" loop="loop" autoplay="autoplay">
        <source src="audio/El-Dorado1.mp3">
      </audio>
    </a>
</span>
<div id="preview">
  <img src="img/add.png">
</div>
<div class="btns clear">
  <a class="chun fl">香吻<span data-num="0"></span></a>
  <a class="egg fr">鸡蛋<span></span></a>
</div>
<img class="chun-pic" src="img/chun.png">
<input class="add hide" type="file" onchange="preview(this)" />
<script src="js/lib/jquery-1.11.3.min.js"></script>
<script src="js/src/wx.js"></script>
<script>
  function play_music(){
    if ($('#mc_play').hasClass('on')){
      $('#mc_play audio').get(0).pause();
      $('#mc_play').attr('class','stop');
    }else{
      $('#mc_play audio').get(0).play();
      $('#mc_play').attr('class','on');
    }
    $('#music_play_filter').hide();
    event.stopPropagation(); //阻止冒泡
  }
  function just_play(id){
    $('#mc_play audio').get(0).play();
    $('#mc_play').attr('class','on');
    if (typeof(id)!='undefined'){
      $('#music_play_filter').hide();
    }
    event.stopPropagation(); //阻止冒泡
  }
  function is_weixn(){
    return false;
    var ua = navigator.userAgent.toLowerCase();
    if(ua.match(/MicroMessenger/i)=="micromessenger") {
      return true;
    } else {
      return false;
    }
  }
  var play_filter=document.getElementById('music_play_filter');
  play_filter.addEventListener('click', function(){
    just_play(1);
  });
  play_filter.addEventListener('touchstart', function(){
    just_play(1);
  });
  play_filter.addEventListener('touchend', function(){
    just_play(1);
  });
  play_filter.addEventListener('touchmove', function(){
    just_play(1);
  });
  play_filter.addEventListener('mousedown', function(){
    just_play(1);
  });
  play_filter.addEventListener('mouseup', function(){
    just_play(1);
  });
  play_filter.addEventListener('mousemove',function(){
    just_play(1);
  });
  play_music() ;
  window.onload=function(){
    if (!is_weixn()){
      just_play();
    }
  };

  function preview(file)
  {
    var prevDiv = document.getElementById('preview');
    if (file.files && file.files[0])
    {
      var reader = new FileReader();
      reader.onload = function(evt){
        prevDiv.innerHTML = '<img src="' + evt.target.result + '" />';
      }
      reader.readAsDataURL(file.files[0]);
    }
    else
    {
      prevDiv.innerHTML = '<div class="img" style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + file.value + '\'"></div>';
    }
  }
</script>

</body>
</html>